<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Editing Selection files • RSMinerveR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Editing Selection files">
<meta property="og:description" content="RSMinerveR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RSMinerveR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Editing-Selection-files.html">Editing Selection files</a>
    </li>
    <li>
      <a href="../articles/Example-01.html">Example-01</a>
    </li>
    <li>
      <a href="../articles/Example-02.html">Example-02</a>
    </li>
    <li>
      <a href="../articles/Example-03.html">Example-03</a>
    </li>
    <li>
      <a href="../articles/Example-04.html">Example-04</a>
    </li>
    <li>
      <a href="../articles/Example-05.html">Example-05</a>
    </li>
    <li>
      <a href="../articles/Example-06.html">Example-06</a>
    </li>
    <li>
      <a href="../articles/OverviewObjects.html">Overview Objects Implemented</a>
    </li>
    <li>
      <a href="../articles/Troubleshooting.html">Troubleshooting</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hydrosolutions/RSMinerveR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Editing-Selection-files_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Editing Selection files</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hydrosolutions/RSMinerveR/blob/master/vignettes/Editing-Selection-files.Rmd"><code>vignettes/Editing-Selection-files.Rmd</code></a></small>
      <div class="hidden name"><code>Editing-Selection-files.Rmd</code></div>

    </div>

    
    
<p>RS Minerve can plot simulation results and print result files for selections of simulation results. These selections can be edited in the user interface, saved to a chk file and also loaded from chk files. As the manual editing of the plot selection can be tedious for large models, it can be useful to automate the reading and writing of the chk files in R. The present vignette demonstrates how to do this.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hydrosolutions.github.io/RSMinerveR/index.html">RSMinerveR</a></span><span class="op">)</span></code></pre></div>
<div id="reading-a-chk-file" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-a-chk-file" class="anchor"></a>Reading a chk file</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filepath</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="st">"../tests/testthat/test_selection.chk"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
   <span class="st">"../tests/testthat/test_selection.chk"</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="st">"https://raw.githubusercontent.com/hydrosolutions/RSMinerveR/main/tests/testthat/test_selection.chk"</span>
<span class="op">}</span>

<span class="va">xmldata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readSelectionCHK.html">readSelectionCHK</a></span><span class="op">(</span><span class="va">filepath</span><span class="op">)</span></code></pre></div>
<p>The name of the selection:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">selection_name</span> <span class="op">&lt;-</span> <span class="va">xmldata</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">selection_name</span><span class="op">)</span>
<span class="co">#&gt; [1] "New selection"</span></code></pre></div>
<p>The description of the objects in the selection:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">selection_data</span> <span class="op">&lt;-</span> <span class="va">xmldata</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">selection_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 29 x 4</span>
<span class="co">#&gt;    Model       Object     ID                   Variable                </span>
<span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;                &lt;chr&gt;                   </span>
<span class="co">#&gt;  1 Model Koksu Source     QSpring              Kichkinesay - QUp (m3/s)</span>
<span class="co">#&gt;  2 Model Koksu Comparator Comparator 1         QReference (m3/s)       </span>
<span class="co">#&gt;  3 Model Koksu Comparator Comparator 1         QSimulation (m3/s)      </span>
<span class="co">#&gt;  4 Model Koksu HBV92      Koksu downstream_eb1 Qr (m3/s)               </span>
<span class="co">#&gt;  5 Model Koksu HBV92      Koksu downstream_eb1 Qu (m3/s)               </span>
<span class="co">#&gt;  6 Model Koksu HBV92      Koksu downstream_eb1 Ql (m3/s)               </span>
<span class="co">#&gt;  7 Model Koksu HBV92      Koksu downstream_eb1 ETR (m/s)               </span>
<span class="co">#&gt;  8 Model Koksu HBV92      Koksu downstream_eb1 Peq (m/s)               </span>
<span class="co">#&gt;  9 Model Koksu HBV92      Koksu downstream_eb1 SWE (m)                 </span>
<span class="co">#&gt; 10 Model Koksu HBV92      Koksu downstream_eb1 WH (-)                  </span>
<span class="co">#&gt; # ... with 19 more rows</span></code></pre></div>
</div>
<div id="write-a-new-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#write-a-new-selection" class="anchor"></a>Write a new selection</h2>
<p>New selection name</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_selection_name</span> <span class="op">&lt;-</span> <span class="st">"SOCONT Qtot"</span></code></pre></div>
<p>Edit the selection to include all data for variable Qtot of all SOCONT objects in the model. To get a list of all SOCONT objects the user can read a parameter file or a file of initial conditions of the model. Another possibility is to read the gis layer with the hydrological response units used for the semi-automatic model creation in RSMinerve.<br>
Let’s read the names of the SOCONT objects from the parameter file of one of the tutorials. The procedure is, of course, analogous for any other RSMinerve Object for which data should be extracted.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">parfilepath</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="st">"../tests/testthat/Tutorial_Parameters.txt"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
   <span class="st">"../tests/testthat/Tutorial_Parameters.txt"</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="st">"https://raw.githubusercontent.com/hydrosolutions/RSMinerveR/main/tests/testthat/Tutorial_Parameters.txt"</span>
<span class="op">}</span>
<span class="va">par</span> <span class="op">&lt;-</span> <span class="fu">RSMinerveR</span><span class="fu">::</span><span class="fu"><a href="../reference/readRSMParameters.html">readRSMParameters</a></span><span class="op">(</span><span class="va">parfilepath</span><span class="op">)</span> |&gt; 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Object</span> <span class="op">==</span> <span class="st">"SOCONT"</span><span class="op">)</span>
<span class="va">Object_IDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">Object_IDs</span><span class="op">)</span>
<span class="co">#&gt; [1] "SOCONT 1" "SOCONT 2" "SOCONT 3"</span></code></pre></div>
<p>Now construct a tibble of the variables for each object we’d like to select results from.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_selection</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Tutorial_Model"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Object_IDs</span><span class="op">)</span><span class="op">)</span>, 
  Object <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"SOCONT"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Object_IDs</span><span class="op">)</span><span class="op">)</span>, 
  ID <span class="op">=</span> <span class="va">Object_IDs</span>, 
  Variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Qtot (m3/s)"</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">new_selection</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 3 x 4</span>
<span class="co">#&gt;   Model          Object ID       Variable   </span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;      </span>
<span class="co">#&gt; 1 Tutorial_Model SOCONT SOCONT 1 Qtot (m3/s)</span>
<span class="co">#&gt; 2 Tutorial_Model SOCONT SOCONT 2 Qtot (m3/s)</span>
<span class="co">#&gt; 3 Tutorial_Model SOCONT SOCONT 3 Qtot (m3/s)</span></code></pre></div>
<p>Now write the data to a new file. In the codechuck below you will need to replace <code>&lt;filepath&gt;</code> with an actual path to a file to write.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeSelectionCHK</span>(<span class="sc">&lt;</span>filepath<span class="sc">&gt;</span>, new_selection, new_selection_name)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Beatrice Marti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
